---
phase: 07-polish-optimization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/(dashboard)/layout.tsx
  - src/components/layout/sidebar.tsx
  - src/components/layout/header.tsx
  - src/components/layout/mobile-nav.tsx
  - src/hooks/use-media-query.ts
autonomous: true

must_haves:
  truths:
    - "Sidebar jest ukryty na mobile (<1024px)"
    - "Hamburger menu otwiera drawer z nawigacja na mobile"
    - "Content zajmuje pelna szerokosc na mobile"
    - "Wszystkie elementy nawigacji sa dostepne na mobile"
    - "Touch targets maja minimum 44x44px"
  artifacts:
    - path: "src/components/layout/mobile-nav.tsx"
      provides: "Mobile drawer navigation with Sheet"
      min_lines: 40
    - path: "src/hooks/use-media-query.ts"
      provides: "SSR-safe media query hook"
      exports: ["useMediaQuery"]
    - path: "src/app/(dashboard)/layout.tsx"
      provides: "Responsive layout with lg:pl-60"
      contains: "lg:pl-60"
  key_links:
    - from: "src/app/(dashboard)/layout.tsx"
      to: "src/components/layout/mobile-nav.tsx"
      via: "conditional render on mobile"
      pattern: "lg:hidden"
    - from: "src/components/layout/mobile-nav.tsx"
      to: "shadcn Sheet"
      via: "drawer component"
      pattern: "Sheet"
---

<objective>
Naprawic responsywny design dashboardu - sidebar ukryty na mobile z drawer nawigacja.

Purpose: Spelnienie wymagania UX-02 - aplikacja musi dzialac na urzadzeniach mobilnych
Output: Dashboard layout responsywny z collapsible sidebar i mobile drawer
</objective>

<execution_context>
@C:\Users\dariu\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\dariu\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-polish-optimization/07-RESEARCH.md

# Pattern references
# Tailwind v4 breakpoints: sm=640px, md=768px, lg=1024px
# shadcn/ui Sheet component for mobile drawer
# useMediaQuery hook for responsive behavior
</context>

<tasks>

<task type="auto">
  <name>Task 1: Dodaj useMediaQuery hook i zainstaluj Sheet</name>
  <files>src/hooks/use-media-query.ts, package.json, src/components/ui/sheet.tsx</files>
  <action>
1. Utworz src/hooks/use-media-query.ts z SSR-safe implementacja:
```typescript
'use client';
import { useEffect, useState } from 'react';

export function useMediaQuery(query: string) {
  const [matches, setMatches] = useState(false);

  useEffect(() => {
    const media = window.matchMedia(query);
    if (media.matches !== matches) {
      setMatches(media.matches);
    }
    const listener = () => setMatches(media.matches);
    media.addEventListener('change', listener);
    return () => media.removeEventListener('change', listener);
  }, [matches, query]);

  return matches;
}
```

2. Zainstaluj shadcn Sheet component:
```bash
npx shadcn@latest add sheet
```

Uwaga: Hook zwraca false podczas SSR (bezpieczne dla hydration).
  </action>
  <verify>
- Plik src/hooks/use-media-query.ts istnieje
- Plik src/components/ui/sheet.tsx istnieje po instalacji shadcn
- `npm run build` przechodzi bez bledow
  </verify>
  <done>Hook useMediaQuery dziala i Sheet component zainstalowany</done>
</task>

<task type="auto">
  <name>Task 2: Utworz MobileNav z Sheet drawer</name>
  <files>src/components/layout/mobile-nav.tsx</files>
  <action>
Utworz src/components/layout/mobile-nav.tsx:

1. Client component z Sheet (drawer) z lewej strony
2. Przycisk hamburgera (Menu icon z lucide-react) w header
3. Drawer zawiera te same navItems co Sidebar (skopiuj logike)
4. Po kliknieciu na link - zamknij drawer (onOpenChange)
5. Logo "Wirtualny Mentor" na gorze drawera
6. Touch targets: min-h-11 dla wszystkich linkow

Struktura:
```typescript
'use client';
import { Sheet, SheetContent, SheetTrigger, SheetHeader, SheetTitle } from '@/components/ui/sheet';
import { Button } from '@/components/ui/button';
import { Menu } from 'lucide-react';
import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { useState } from 'react';
// ... navItems (te same co w Sidebar)

export function MobileNav() {
  const [open, setOpen] = useState(false);
  const pathname = usePathname();
  // ...
}
```

Kluczowe:
- side="left" dla Sheet
- Zamykanie po kliknieciu linku: onClick={() => setOpen(false)}
- Aktywny link ma bg-primary text-primary-foreground
  </action>
  <verify>
- Plik src/components/layout/mobile-nav.tsx istnieje
- Eksportuje MobileNav component
- Import Sheet i Menu dziala
- `npm run build` przechodzi
  </verify>
  <done>MobileNav component gotowy z drawer navigation</done>
</task>

<task type="auto">
  <name>Task 3: Zaktualizuj layout i sidebar dla responsive</name>
  <files>src/app/(dashboard)/layout.tsx, src/components/layout/sidebar.tsx, src/components/layout/header.tsx</files>
  <action>
1. Zaktualizuj src/components/layout/sidebar.tsx:
   - Dodaj `hidden lg:block` do aside (ukryty na mobile)
   - Zachowaj reszta bez zmian

2. Zaktualizuj src/app/(dashboard)/layout.tsx:
   - Zmien `pl-60` na `lg:pl-60` (pelna szerokosc na mobile)
   - Dodaj MobileNav widoczny tylko na mobile
   - Zmien `p-6` na `p-4 lg:p-6` w main

Przyklad layout:
```tsx
import { MobileNav } from "@/components/layout/mobile-nav";

// W return:
<div className="min-h-screen bg-background">
  <Sidebar />
  <div className="lg:pl-60">
    {/* Mobile nav - visible only on small screens */}
    <div className="lg:hidden fixed top-0 left-0 z-50">
      <MobileNav />
    </div>
    <Header user={user} />
    <main className="p-4 lg:p-6">{children}</main>
  </div>
</div>
```

3. Opcjonalnie zaktualizuj src/components/layout/header.tsx:
   - Dodaj padding-left na mobile dla miejsca na hamburger: `px-4 pl-14 lg:pl-6 lg:px-6`
  </action>
  <verify>
- `npm run build` przechodzi bez bledow
- Na szerokosci <1024px sidebar niewidoczny
- Na szerokosci >=1024px sidebar widoczny
- MobileNav widoczny tylko na <1024px
  </verify>
  <done>Layout responsywny - sidebar ukryty na mobile, drawer dostepny</done>
</task>

</tasks>

<verification>
1. Uruchom `npm run dev` i sprawdz w DevTools:
   - Mobile (375px): sidebar ukryty, hamburger widoczny, drawer otwiera sie
   - Tablet (768px): sidebar ukryty, hamburger widoczny
   - Desktop (1024px+): sidebar widoczny, hamburger ukryty

2. Sprawdz nawigacje:
   - Wszystkie linki dzialaja z drawera
   - Drawer zamyka sie po kliknieciu linku
   - Aktywny link ma poprawne podswietlenie

3. `npm run build` przechodzi bez bledow
</verification>

<success_criteria>
- [ ] Sidebar ukryty na mobile (<1024px)
- [ ] Hamburger menu widoczny na mobile
- [ ] Drawer otwiera sie z lewej strony
- [ ] Wszystkie navItems dostepne w drawer
- [ ] Content pelna szerokosc na mobile
- [ ] Build przechodzi bez bledow
</success_criteria>

<output>
After completion, create `.planning/phases/07-polish-optimization/07-01-SUMMARY.md`
</output>
